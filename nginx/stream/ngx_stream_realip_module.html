<!DOCTYPE html>
<html lang="zh-cn">
<head>
<title>stream/ngx_stream_realip_module-nginx中文手册</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="None"/>
<meta name="keywords" content="set,real,ip,192.168,listen"/>
</head>
<body>
<div id="content"><h2 class="notranslate">Module ngx_stream_realip_module</h2><table width="100%"><tbody><tr><td align="left" class="notranslate"> <a href="#example">Example Configuration</a> <br> <a href="#directives">Directives</a> <br>     <a href="#set_real_ip_from">set_real_ip_from</a> <br> <a href="#variables">Embedded Variables</a> <br></td></tr></tbody></table><a name="summary"></a><p>   <code class="notranslate">ngx_stream_realip_module</code>模块用于将客户端地址和端口更改为PROXY协议头（1.11.4）中发送的端口和端口。  必须先通过在<code class="notranslate">listen</code>指令中设置<a href="ngx_stream_core_module.html#proxy_protocol">proxy_protocol</a>参数来启用PROXY协议。 </p><p>  默认情况下不构建此模块，应使用<code class="notranslate">--with-stream_realip_module</code>配置参数启用它。 </p><a name="example"></a><center><h4>  示例配置 </h4></center><p></p><blockquote class="example"><pre class="notranslate">listen 12345 proxy_protocol;

set_real_ip_from  192.168.1.0/24;
set_real_ip_from  192.168.2.1;
set_real_ip_from  2001:0db8::/32;
</pre></blockquote><p></p><a name="directives"></a><center><h4>  指令 </h4></center><a name="set_real_ip_from"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>set_real_ip_from</strong> 
    <code class="notranslate"><i>address</i></code> |
    <code class="notranslate"><i>CIDR</i></code> |
    <code class="notranslate">unix:</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            
            —
        
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">stream</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  定义已知可发送正确替换地址的可信地址。  如果指定了特殊值<code class="notranslate">unix:</code>则所有UNIX域套接字都将受信任。 </p><a name="variables"></a><center><h4>  嵌入式变量 </h4></center><p></p><dl class="compact"><dt id="var_realip_remote_addr"> <code class="notranslate">$realip_remote_addr</code> </dt> <dd>  保留原始客户端地址 </dd><dt id="var_realip_remote_port"> <code class="notranslate">$realip_remote_port</code> </dt> <dd>  保留原始客户端端口 </dd></dl><p></p> 
<span></span><div style="display: none;"></div></div>
</body>
</html>