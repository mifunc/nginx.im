<!DOCTYPE html>
<html lang="zh-cn">
<head>
<title>http/ngx_http_image_filter_module-nginx中文手册</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="None"/>
<meta name="keywords" content="image,filter,100,empty,location"/>
</head>
<body>
<div id="content"><h2 class="notranslate">Module ngx_http_image_filter_module</h2><table width="100%"><tbody><tr><td align="left" class="notranslate"> <a href="#example">Example Configuration</a> <br> <a href="#directives">Directives</a> <br>     <a href="#image_filter">image_filter</a> <br>     <a href="#image_filter_buffer">image_filter_buffer</a> <br>     <a href="#image_filter_interlace">image_filter_interlace</a> <br>     <a href="#image_filter_jpeg_quality">image_filter_jpeg_quality</a> <br>     <a href="#image_filter_sharpen">image_filter_sharpen</a> <br>     <a href="#image_filter_transparency">image_filter_transparency</a> <br>     <a href="#image_filter_webp_quality">image_filter_webp_quality</a> <br></td></tr></tbody></table><a name="summary"></a><p>   <code class="notranslate">ngx_http_image_filter_module</code>模块（0.7.54+）是一个过滤器，可以转换JPEG，GIF，PNG和WebP格式的图像。 </p><p>  默认情况下不构建此模块，应使用<code class="notranslate">--with-http_image_filter_module</code>配置参数启用它。 </p><blockquote class="note">  该模块使用<a href="http://libgd.org">libgd</a>库。  建议使用最新版本的库。 </blockquote><p></p><blockquote class="note">   WebP格式支持出现在1.11.6版中。  要以此格式转换图像，必须使用WebP支持编译<code class="notranslate">libgd</code>库。 </blockquote><p></p><a name="example"></a><center><h4>  示例配置 </h4></center><p></p><blockquote class="example"><pre class="notranslate">location /img/ {
    proxy_pass   http://backend;
    image_filter resize 150 100;
    image_filter rotate 90;
    error_page   415 = /empty;
}

location = /empty {
    empty_gif;
}
</pre></blockquote><p></p><a name="directives"></a><center><h4>  指令 </h4></center><a name="image_filter"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter</strong> <code class="notranslate">off</code> ;</code> <br> <code class="notranslate"><strong>image_filter</strong> <code class="notranslate">test</code> ;</code> <br> <code class="notranslate"><strong>image_filter</strong> <code class="notranslate">size</code> ;</code> <br> <code class="notranslate"><strong>image_filter</strong> 
    <code class="notranslate">rotate</code>
    <code class="notranslate">90</code> | <code class="notranslate">180</code> |
    <code class="notranslate">270</code> ;</code> <br> <code class="notranslate"><strong>image_filter</strong> 
    <code class="notranslate">resize</code>
    <code class="notranslate"><i>width</i></code>
    <code class="notranslate"><i>height</i></code> ;</code> <br> <code class="notranslate"><strong>image_filter</strong> 
    <code class="notranslate">crop</code>
    <code class="notranslate"><i>width</i></code>
    <code class="notranslate"><i>height</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置要对图像执行的转换类型： </p><dl class="compact"><dt> <code class="notranslate">off</code> </dt> <dd>  关闭周围位置的模块处理。 </dd><dt> <code class="notranslate">test</code> </dt> <dd>  确保响应是JPEG，GIF，PNG或WebP格式的图像。  否则，将返回415（不支持的媒体类型）错误。 </dd><dt> <code class="notranslate">size</code> </dt> <dd>  以JSON格式输出有关图像的信息，例如： <blockquote class="example"><pre class="notranslate">{ "img" : { "width": 100, "height": 100, "type": "gif" } }
</pre></blockquote>  如果出现错误，输出如下： <blockquote class="example"><pre class="notranslate">{}
</pre></blockquote></dd><dt>   <code class="notranslate">rotate</code> <code class="notranslate">90</code> |   <code class="notranslate">180</code> | <code class="notranslate">270</code> </dt><dd>  逆时针旋转图像指定的度数。  参数值可以包含变量。  此模式既可以单独使用，也可以与<code class="notranslate">resize</code>和<code class="notranslate">crop</code>变换一起使用。 </dd><dt>   <code class="notranslate">resize</code> <code class="notranslate"><i>width</i></code> <code class="notranslate"><i>height</i></code> </dt><dd>  按比例将图像缩小到指定的大小。  要仅减少一个维度，可以将另一个维度指定为“ <code class="notranslate">-</code> ”。  如果出现错误，服务器将返回代码415（不支持的介质类型）。  参数值可以包含变量。  与<code class="notranslate">rotate</code>参数一起使用时，旋转会<strong>在</strong>缩小<strong>后</strong>发生。 </dd><dt>   <code class="notranslate">crop</code> <code class="notranslate"><i>width</i></code> <code class="notranslate"><i>height</i></code> </dt><dd>  按比例将图像缩小到较大的边尺寸，并通过另一面裁剪外部边缘。  要仅减少一个维度，可以将另一个维度指定为“ <code class="notranslate">-</code> ”。  如果出现错误，服务器将返回代码415（不支持的介质类型）。  参数值可以包含变量。  与<code class="notranslate">rotate</code>参数一起使用时， <code class="notranslate">rotate</code> <strong>在</strong>缩小<strong>之前</strong>发生。 </dd></dl><p></p><a name="image_filter_buffer"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_buffer</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_buffer 1M;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置用于读取图像的缓冲区的最大大小。  超出大小时，服务器返回错误415（不支持的介质类型）。 </p><a name="image_filter_interlace"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_interlace</strong> <code class="notranslate">on</code> | <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_interlace off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.3.15版本中。 </p></div><p>  如果启用，最终图像将被隔行扫描。  对于JPEG，最终图像将采用“渐进式JPEG”格式。 </p><a name="image_filter_jpeg_quality"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_jpeg_quality</strong> <code class="notranslate"><i>quality</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_jpeg_quality 75;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置变换后的JPEG图像的所需<code class="notranslate"><i>quality</i></code> 。  可接受的值在1到100的范围内。较小的值通常意味着较低的图像质量和较少的传输数据。  建议的最大值为95.参数值可以包含变量。 </p><a name="image_filter_sharpen"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_sharpen</strong> <code class="notranslate"><i>percent</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_sharpen 0;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  增加最终图像的清晰度。  锐度百分比可以超过100.零值禁用锐化。  参数值可以包含变量。 </p><a name="image_filter_transparency"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_transparency</strong> <code class="notranslate">on</code> | <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_transparency on;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  定义在使用调色板指定的颜色转换GIF图像或PNG图像时是否应保留透明度。  透明度的丧失导致图像质量更好。  始终保留PNG中的Alpha通道透明度。 </p><a name="image_filter_webp_quality"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>image_filter_webp_quality</strong> <code class="notranslate"><i>quality</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">image_filter_webp_quality 80;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.11.6版中。 </p></div><p>  设置转换的WebP图像的所需<code class="notranslate"><i>quality</i></code> 。  可接受的值在1到100的范围内。较小的值通常意味着较低的图像质量和较少的传输数据。  参数值可以包含变量。 </p> 
<span></span><div style="display: none;"></div></div>
</body>
</html>