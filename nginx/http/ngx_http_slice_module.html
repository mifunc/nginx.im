<!DOCTYPE html>
<html lang="zh-cn">
<head>
<title>http/ngx_http_slice_module-nginx中文手册</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="None"/>
<meta name="keywords" content="proxy,slice,cache,args,range"/>
</head>
<body>
<div id="content"><h2 class="notranslate">Module ngx_http_slice_module</h2><table width="100%"><tbody><tr><td align="left" class="notranslate"> <a href="#example">Example Configuration</a> <br> <a href="#directives">Directives</a> <br>     <a href="#slice">slice</a> <br> <a href="#variables">Embedded Variables</a> <br></td></tr></tbody></table><a name="summary"></a><p>   <code class="notranslate">ngx_http_slice_module</code>模块（1.9.8）是一个过滤器，它将请求拆分为子请求，每个子请求都返回一定范围的响应。  过滤器提供更有效的大响应缓存。 </p><p>  默认情况下不构建此模块，应使用<code class="notranslate">--with-http_slice_module</code>配置参数启用它。 </p><a name="example"></a><center><h4>  示例配置 </h4></center><p></p><blockquote class="example"><pre class="notranslate">location / {
    <strong>slice</strong>             1m;
    proxy_cache       cache;
    proxy_cache_key   $uri$is_args$args <strong>$slice_range</strong> ;
    proxy_set_header  Range <strong>$slice_range</strong> ;
    proxy_cache_valid 200 206 1h;
    proxy_pass        http://localhost:8000;
}
</pre></blockquote><p>  在此示例中，响应被拆分为1兆字节的可缓存切片。 </p><a name="directives"></a><center><h4>  指令 </h4></center><a name="slice"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>slice</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">slice 0;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置切片的<code class="notranslate"><i>size</i></code> 。  零值禁用将响应拆分为切片。  请注意，值太低可能会导致内存使用过多并打开大量文件。 </p><p>  为了使子请求返回所需的范围， <code class="notranslate">$slice_range</code>变量应作为<code class="notranslate">Range</code>请求头字段<a href="ngx_http_proxy_module.html#proxy_set_header">传递</a>给代理服务器。  如果启用了<a href="ngx_http_proxy_module.html#proxy_cache">缓存</a> ，则应将<code class="notranslate">$slice_range</code>添加到<a href="ngx_http_proxy_module.html#proxy_cache_key">缓存键，</a>并<a href="ngx_http_proxy_module.html#proxy_cache_valid">启用</a>具有206状态代码的响应缓存。 </p><a name="variables"></a><center><h4>  嵌入式变量 </h4></center><p>   <code class="notranslate">ngx_http_slice_module</code>模块支持以下嵌入变量： </p><dl class="compact"><dt id="var_slice_range"> <code class="notranslate">$slice_range</code> </dt> <dd>   <a href="https://tools.ietf.org/html/rfc7233#section-2.1">HTTP字节范围</a>格式的当前切片范围，例如， <code class="notranslate">bytes=0-1048575</code> 。 </dd></dl><p></p> 
<span></span><div style="display: none;"></div></div>
</body>
</html>