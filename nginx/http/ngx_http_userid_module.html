<!DOCTYPE html>
<html lang="zh-cn">
<head>
<title>http/ngx_http_userid_module-nginx中文手册</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="None"/>
<meta name="keywords" content="userid,p3p,off,name,uid"/>
</head>
<body>
<div id="content"><h2 class="notranslate">Module ngx_http_userid_module</h2><table width="100%"><tbody><tr><td align="left" class="notranslate"> <a href="#example">Example Configuration</a> <br> <a href="#directives">Directives</a> <br>     <a href="#userid">userid</a> <br>     <a href="#userid_domain">userid_domain</a> <br>     <a href="#userid_expires">userid_expires</a> <br>     <a href="#userid_mark">userid_mark</a> <br>     <a href="#userid_name">userid_name</a> <br>     <a href="#userid_p3p">userid_p3p</a> <br>     <a href="#userid_path">userid_path</a> <br>     <a href="#userid_service">userid_service</a> <br> <a href="#variables">Embedded Variables</a> <br></td></tr></tbody></table><a name="summary"></a><p>   <code class="notranslate">ngx_http_userid_module</code>模块设置适合客户端识别的cookie。  可以使用嵌入变量<a href="#var_uid_got">$ uid_got</a>和<a href="#var_uid_set">$ uid_set</a>记录已接收和设置的cookie。  该模块与Apache的<a href="http://www.lexa.ru/programs/mod-uid-eng.html">mod_uid</a>模块兼容。 </p><a name="example"></a><center><h4>  示例配置 </h4></center><p></p><blockquote class="example"><pre class="notranslate">userid         on;
userid_name    uid;
userid_domain  example.com;
userid_path    /;
userid_expires 365d;
userid_p3p     'policyref="/w3c/p3p.xml", CP="CUR ADM OUR NOR STA NID"';
</pre></blockquote><p></p><a name="directives"></a><center><h4>  指令 </h4></center><a name="userid"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid</strong> 
    <code class="notranslate">on</code> |
    <code class="notranslate">v1</code> |
    <code class="notranslate">log</code> |
    <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  启用或禁用设置cookie并记录收到的cookie： </p><dl class="compact"><dt> <code class="notranslate">on</code> </dt> <dd>  可以设置版本2 cookie并记录收到的cookie; </dd><dt> <code class="notranslate">v1</code> </dt> <dd>  可以设置版本1 cookie并记录收到的cookie; </dd><dt> <code class="notranslate">log</code> </dt> <dd>  禁用cookie的设置，但允许记录收到的cookie; </dd><dt> <code class="notranslate">off</code> </dt> <dd>  禁用cookie的设置和记录收到的cookie。 </dd></dl><p></p><a name="userid_domain"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_domain</strong> <code class="notranslate"><i>name</i></code> | <code class="notranslate">none</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_domain none;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  定义为其设置cookie的域。   <code class="notranslate">none</code>参数禁用cookie的域设置。 </p><a name="userid_expires"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_expires</strong> <code class="notranslate"><i>time</i></code> | <code class="notranslate">max</code> |
    <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_expires off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置浏览器保留cookie的时间。  参数<code class="notranslate">max</code>将导致cookie在“ <code class="notranslate">31 Dec 2037 23:55:55 GMT</code> ”到期。  参数<code class="notranslate">off</code>将导致cookie在浏览器会话结束时到期。 </p><a name="userid_mark"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_mark</strong> 
    <code class="notranslate"><i>letter</i></code> | <code class="notranslate"><i>digit</i></code> |
    <code class="notranslate">=</code> |
    <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_mark off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  如果参数未<code class="notranslate">off</code> ，则启用cookie标记机制并设置用作标记的字符。  此机制用于在保留客户端标识符的同时添加或更改<a href="#userid_p3p">userid_p3p</a>和/或cookie过期时间。  标记可以是英文字母（区分大小写），数字或“ <code class="notranslate">=</code> ”字符的任何字母。 </p><p>  如果设置了标记，则将其与cookie中传递的客户端标识符的base64表示中的第一个填充符号进行比较。  如果它们不匹配，则会使用指定的标记，到期时间和“P3P”标头重新发送cookie。 </p><a name="userid_name"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_name</strong> <code class="notranslate"><i>name</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_name uid;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置cookie名称。 </p><a name="userid_p3p"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_p3p</strong> <code class="notranslate"><i>string</i></code> | <code class="notranslate">none</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_p3p none;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置将与cookie一起发送的“P3P”标题字段的值。  如果指令设置为特殊值<code class="notranslate">none</code> ，则不会在响应中发送“P3P”标头。 </p><a name="userid_path"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_path</strong> <code class="notranslate"><i>path</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_path /;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  定义cookie的设置路径。 </p><a name="userid_service"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>userid_service</strong> <code class="notranslate"><i>number</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">userid_service IP address of the server;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  如果标识符由多个服务器（服务）发出，则应为每个服务分配其自己的<code class="notranslate"><i>number</i></code>以确保客户端标识符是唯一的。  对于版本1 cookie，默认值为零。  对于版本2 cookie，默认值是由服务器IP地址的最后四个八位字节组成的数字。 </p><a name="variables"></a><center><h4>  嵌入式变量 </h4></center><p>   <code class="notranslate">ngx_http_userid_module</code>模块支持以下嵌入变量： </p><dl class="compact"><dt id="var_uid_got"> <code class="notranslate">$uid_got</code> </dt> <dd>   Cookie名称和已接收的客户端标识符。 </dd><dt id="var_uid_reset"> <code class="notranslate">$uid_reset</code> </dt> <dd>  如果变量设置为非空字符串不是“ <code class="notranslate">0</code> ”，则重置客户端标识符。  特殊值“ <code class="notranslate">log</code> ”还导致将关于重置标识符的消息输出到<a href="ngx_core_module.html#error_log">error_log</a> 。 </dd><dt id="var_uid_set"> <code class="notranslate">$uid_set</code> </dt> <dd>   Cookie名称和已发送的客户端标识符。 </dd></dl><p></p> 
<span></span><div style="display: none;"></div></div>
</body>
</html>