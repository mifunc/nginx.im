<!DOCTYPE html>
<html lang="zh-cn">
<head>
<title>http/ngx_http_v2_module-nginx中文手册</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="None"/>
<meta name="keywords" content="http2,size,max,server,ssl"/>
</head>
<body>
<div id="content"><h2 class="notranslate">Module ngx_http_v2_module</h2><table width="100%"><tbody><tr><td align="left" class="notranslate"> <a href="#issues">Known Issues</a> <br> <a href="#example">Example Configuration</a> <br> <a href="#directives">Directives</a> <br>     <a href="#http2_body_preread_size">http2_body_preread_size</a> <br>     <a href="#http2_chunk_size">http2_chunk_size</a> <br>     <a href="#http2_idle_timeout">http2_idle_timeout</a> <br>     <a href="#http2_max_concurrent_pushes">http2_max_concurrent_pushes</a> <br>     <a href="#http2_max_concurrent_streams">http2_max_concurrent_streams</a> <br>     <a href="#http2_max_field_size">http2_max_field_size</a> <br>     <a href="#http2_max_header_size">http2_max_header_size</a> <br>     <a href="#http2_max_requests">http2_max_requests</a> <br>     <a href="#http2_push">http2_push</a> <br>     <a href="#http2_push_preload">http2_push_preload</a> <br>     <a href="#http2_recv_buffer_size">http2_recv_buffer_size</a> <br>     <a href="#http2_recv_timeout">http2_recv_timeout</a> <br> <a href="#variables">Embedded Variables</a> <br></td></tr></tbody></table><a name="summary"></a><p>   <code class="notranslate">ngx_http_v2_module</code>模块（1.9.5）提供对<a href="https://tools.ietf.org/html/rfc7540">HTTP / 2的</a>支持并取代<a href="ngx_http_spdy_module.html">ngx_http_spdy_module</a>模块。 </p><p>  默认情况下不构建此模块，应使用<code class="notranslate">--with-http_v2_module</code>配置参数启用它。 </p><a name="issues"></a><center><h4>  已知的问题 </h4></center><p>  在版本1.9.14之前，无论<a href="ngx_http_proxy_module.html#proxy_request_buffering">proxy_request_buffering</a> ， <a href="ngx_http_fastcgi_module.html#fastcgi_request_buffering">fastcgi_request_buffering</a> ， <a href="ngx_http_uwsgi_module.html#uwsgi_request_buffering">uwsgi_request_buffering</a>和<a href="ngx_http_scgi_module.html#scgi_request_buffering">scgi_request_buffering</a>指令值如何，都无法禁用客户端请求正文的缓冲。 </p><a name="example"></a><center><h4>  示例配置 </h4></center><p></p><blockquote class="example"><pre class="notranslate">server {
    listen 443 ssl http2;

    ssl_certificate server.crt;
    ssl_certificate_key server.key;
}
</pre></blockquote><p>  请注意，通过TLS接受HTTP / 2连接需要“应用程序层协议协商”（ALPN）TLS扩展支持，该支持仅在<a href="http://www.openssl.org">OpenSSL</a>版本1.0.2之后可用。  为此目的使用“下一协议协商”（NPN）TLS扩展（自OpenSSL版本1.0.1起可用）不能保证有效。 </p><p>  另请注意，如果<a href="ngx_http_ssl_module.html#ssl_prefer_server_ciphers">ssl_prefer_server_ciphers</a>指令设置为值“ <code class="notranslate">on</code> ”，则应将<a href="ngx_http_ssl_module.html#ssl_ciphers">密码</a>配置为符合<a href="https://tools.ietf.org/html/rfc7540#appendix-A">RFC 7540，附录A</a>黑名单并由客户端支持。 </p><a name="directives"></a><center><h4>  指令 </h4></center><a name="http2_body_preread_size"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_body_preread_size</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_body_preread_size 64k;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.11.0版本中。 </p></div><p>  设置在开始处理请求主体之前可以保存请求主体的每个请求的缓冲区<code class="notranslate"><i>size</i></code> 。 </p><a name="http2_chunk_size"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_chunk_size</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_chunk_size 8k;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table></div><p>  设置响应主体被切片到的块的最大大小。  值太低会导致更高的开销。  由于<a href="http://en.wikipedia.org/wiki/Head-of-line_blocking">HOL阻塞，</a>太高的值会损害优先级。 </p><a name="http2_idle_timeout"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_idle_timeout</strong> <code class="notranslate"><i>time</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_idle_timeout 3m;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  设置关闭连接之前的不活动超时。 </p><a name="http2_max_concurrent_pushes"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_max_concurrent_pushes</strong> <code class="notranslate"><i>number</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_max_concurrent_pushes 10;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.13.9版中。 </p></div><p>  限制连接中的最大并发<a href="#http2_push">推送</a>请求数。 </p><a name="http2_max_concurrent_streams"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_max_concurrent_streams</strong> <code class="notranslate"><i>number</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_max_concurrent_streams 128;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  设置连接中的最大并发HTTP / 2流数。 </p><a name="http2_max_field_size"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_max_field_size</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_max_field_size 4k;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  限制<a href="https://tools.ietf.org/html/rfc7541">HPACK</a>压缩请求标头字段的最大大小。  该限制同样适用于名称和价值。  请注意，如果应用了霍夫曼编码，则解压缩的名称和值字符串的实际大小可能会更大。  对于大多数请求，默认限制应该足够。 </p><a name="http2_max_header_size"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_max_header_size</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_max_header_size 16k;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  在<a href="https://tools.ietf.org/html/rfc7541">HPACK</a>解压缩后限制整个请求标头列表的最大大小。  对于大多数请求，默认限制应该足够。 </p><a name="http2_max_requests"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_max_requests</strong> <code class="notranslate"><i>number</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_max_requests 1000;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.11.6版中。 </p></div><p>  设置可通过一个HTTP / 2连接提供的最大请求数（包括<a href="#http2_push">推送</a>请求），之后下一个客户端请求将导致连接关闭以及建立新连接的需要。 </p><a name="http2_push"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_push</strong> <code class="notranslate"><i>uri</i></code> | <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_push off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.13.9版中。 </p></div><p>  先发制人地将请求发送（ <a href="https://tools.ietf.org/html/rfc7540#section-8.2">推送</a> ）到指定的<code class="notranslate"><i>uri</i></code>以及对原始请求的响应。  仅处理具有绝对路径的相对URI，例如： </p><blockquote class="example"><pre class="notranslate">http2_push /static/css/main.css;
</pre></blockquote><p>   <code class="notranslate"><i>uri</i></code>值可以包含变量。 </p><p>  可以在同一配置级别指定多个<code class="notranslate">http2_push</code>指令。   <code class="notranslate">off</code>参数取消了从先前配置级别继承的<code class="notranslate">http2_push</code>指令的效果。 </p><a name="http2_push_preload"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_push_preload</strong> <code class="notranslate">on</code> | <code class="notranslate">off</code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_push_preload off;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> , <code class="notranslate">location</code> <br>
                </td></tr></tbody></table><p>  该指令出现在1.13.9版中。 </p></div><p>  允许将“链接”响应头字段中指定的<a href="https://www.w3.org/TR/preload/#server-push-http-2">预加载链接</a>自动转换为<a href="https://tools.ietf.org/html/rfc7540#section-8.2">推送</a>请求。 </p><a name="http2_recv_buffer_size"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_recv_buffer_size</strong> <code class="notranslate"><i>size</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_recv_buffer_size 256k;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> <br>
                </td></tr></tbody></table></div><p>  设置每个<a href="ngx_core_module.html#worker_processes">工作者</a>输入缓冲区的大小。 </p><a name="http2_recv_timeout"></a><div class="directive"><table cellspacing="0"><tbody><tr><th class="notranslate">
            Syntax:
                </th><td class="notranslate">
            <code class="notranslate"><strong>http2_recv_timeout</strong> <code class="notranslate"><i>time</i></code> ;</code> <br>
                </td></tr><tr><th class="notranslate">
            Default:
                </th><td class="notranslate">
            <pre class="notranslate">http2_recv_timeout 30s;</pre>
                </td></tr><tr><th class="notranslate">
            Context:
                </th><td class="notranslate">
            <code class="notranslate">http</code> , <code class="notranslate">server</code> <br>
                </td></tr></tbody></table></div><p>  设置从客户端获取更多数据的超时，然后关闭连接。 </p><a name="variables"></a><center><h4>  嵌入式变量 </h4></center><p>   <code class="notranslate">ngx_http_v2_module</code>模块支持以下嵌入变量： </p><dl><dt id="var_http2"> <code class="notranslate">$http2</code> </dt> <dd>  协商协议标识符：“ <code class="notranslate">h2</code> ”表示HTTP / 2通过TLS，“ <code class="notranslate">h2c</code> ”表示HTTP / 2通过明文TCP，否则为空字符串。 </dd></dl><p></p> 
<span></span><div style="display: none;"></div></div>
</body>
</html>